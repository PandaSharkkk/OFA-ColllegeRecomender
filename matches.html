<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Recruiter</title>
    <link rel="stylesheet" href="matches.css">
    <link rel="icon" href="book.png" type="image/x-icon">
</head>
<body>
    <div id=taskbar>
        <a href="temp.html" id="book">
            <img id=home src="book.png" alt="book" height="37">
        </a> 

        <box id="topText">College Recruiter</box>
    
    <a href="temp.html">
        <img id=bookmark src="bookmark.png" alt="bookmark" height="33">
    </a>    
   
    <a href="temp.html">
        <img id=profile src="userIcon.png" alt="user" height="37">
    </a>
   
        
</div>

<h1>Your Best Matches !</h1>
    <p id="results">
    </p>

    <script>
        
        var data1 = JSON.parse(sessionStorage.getItem("arr"));
        console.log(data1);
        var container = document.getElementById('results');


        data1.forEach((item, index) => {
            const linkNode = document.createElement('a');
            linkNode.textContent = item;
            container.appendChild(linkNode);
            const urlWithParam = `${"template.html"}?id=${index}`; // Append the unique identifier as a query parameter
            linkNode.href = urlWithParam;
            container.appendChild(document.createTextNode("\u00A0\u00A0\u00A0\u00A0\u00A0")); // Add two more non-breaking spaces between links        
        


        });

        const TABLE_URL = "https://api.airtable.com/v0/appo1y5AaYd3oeCyi/Colleges"; //Defining the link to the database we have setup
        const KEY_QUERY = "api_key=keyDhRLs1MlrCykL7"; //API key
        const SUMMARY_QUERY = "fields%5B%5D=Picture&fields%5B%5D=Name&fields%5B%5D=Location&fields%5B%5D=Average%20GPA&fields%5B%5D=Average%20SAT&fields%5B%5D=Campus%20setting&fields%5B%5D=Acceptance%20Rate&fields%5B%5D=Size&fields%5B%5D=Tuition"; //Defining and linking all of the collumns from our database
        var itemList = [];

        function fetchItemsPage(itemResultElement, offset) {
            fetch(`${TABLE_URL}?${KEY_QUERY}&${SUMMARY_QUERY}&${offset}`)
                .then(response => response.json()) //Makes the database into a array?
                .then(data => {
                    console.log(data);//These 4 lines call the database and then display the data in the console

                    var matchedColleges = ""; //Makes this variable have no words
                    var matchedColleges2 = "No colleges match your search";
                    var arr = new Array();
                    
                    for (var p = 0; p < data.records.length; p++) { //Goes through every value in the database
                        var pictureLink = data.records[p].fields["Picture"];
                        var Tuition = data.records[p].fields["Tuition"];
                        var Name = data.records[p].fields["Name"]; //All of these are just defining collumn from our database as variables
                        var Location = data.records[p].fields["Location"];
                        var GPA = (data.records[p].fields["Average GPA"]);
                        var SAT = data.records[p].fields["Average SAT"];
                        var Size = data.records[p].fields["Size"];
                        var Setting = data.records[p].fields["Campus setting"];
                        var Acceptance = (data.records[p].fields["Acceptance Rate"]);
                    }

                    for (var i = 0; i < data1.length; i++){
                        console.log(data1[i])
                        if (Name == data1[i])
                            console.log(i);
                    }




                    if (data.offset) { //Applies to if their is 100 or more data points in the database
                        offset = `offset=${data.offset}`;
                        fetchItemsPage(itemResultElement, offset);
                    }

                    itemList = itemList.concat(data.records); //list the data
                });
        }
        fetchItemsPage();
    </script>

</body>
</html>